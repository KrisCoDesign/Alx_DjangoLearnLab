{% extends 'base.html' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<div class="post-detail-container">
    <article class="post-detail">
        <header class="post-header">
            <h1>{{ post.title }}</h1>
            <div class="post-meta">
                <span class="author">By {{ post.author.username }}</span>
                <span class="date">Published on {{ post.published_date|date:"F j, Y" }}</span>
                {% if post.author == user %}
                    <span class="author-badge">Your Post</span>
                {% endif %}
            </div>
        </header>
        
        <div class="post-content">
            {{ post.content|linebreaks }}
        </div>
        
        <footer class="post-footer">
            <div class="post-actions">
                <a href="{% url 'post_list' %}" class="btn btn-secondary">Back to Posts</a>
                {% if user == post.author %}
                    <a href="{% url 'post_update' post.pk %}" class="btn btn-warning">Edit Post</a>
                    <a href="{% url 'post_delete' post.pk %}" class="btn btn-danger">Delete Post</a>
                {% endif %}
            </div>
        </footer>
    </article>

<!-- COMMENTS  -->
<h2>Leave your comment!</h2>
<div class="post-detail-container">

  {% if user.is_authenticated %}
  <form method="POST">
    {% csrf_token %}
    <div class="form-group">
      {{ comment_form }}
      <button class="btn btn-info" type="submit">Add comment <i class="fas fa-comments"></i></button>
    </div>
  </form>
  {% else %}
  <a class="btn btn-outline-info" href="{% url 'login' %}?next={{request.path}}">Log in to add a comment!</a><br>
  {% endif %}

  {% if comments %}
  <strong class="text-secondary">{{ object.number_of_comments }} Comment{{ object.number_of_comments|pluralize }}</strong>
  <hr>
  <ul>
    {% for comment in comments %}
    <li>           
     <div>
        <span>
          <strong class="text-info">{{ comment.author }} </strong>
          <small class="text-muted">{{ comment.created_at }}</small>
        </span>
        <p>
          {{ comment.content|safe }}
        </p>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
    <strong class="text-secondary">No comments yet...</strong>
  {% endif %}

</div>


</div>
{% endblock %}


